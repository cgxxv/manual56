### mysqldumpslow — 总结慢查询日志文件

MySQL 慢查询日志记录了执行时间比较长的查询（参见[5.2.5 "慢查询日志"][5.2.5])，[mysqldumpslow](#) 解释慢查询日志内容然后输出概要信息。


通常来讲，[mysqldumpslow](#) 把相似查询归为一组除了那些有特殊值的数值或者字符串，当现实概要信息的时候，被抽象成 'N' 或者 'S'，`-a` 和 `-n` 选项可以用来更改抽象行为的值。

[mysqldumpslow](#) 调用如下：

```shell
shell> mysqldumpslow [options] [log_file ...]
```

[mysqldump](#) 支持如下选项：

<table summary="mysqldumpslow Options" border="1">
    <colgroup>
        <col class="format">
            <col class="config_file">
                <col class="description">
    </colgroup>
    <thead>
        <tr>
            <th scope="col">
                Format
            </th>
            <th scope="col">
                Option File
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_abstract">
                    -a
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Do not abstract all numbers to N and strings to S
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_abstract-numbers">
                    -n num
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Abstract numbers with at least the specified digits
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_debug">
                    --debug
                </a>
            </td>
            <td>
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_debug">
                    debug
                </a>
            </td>
            <td>
                Write debugging information
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_grep">
                    -g pattern
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Only consider statements that match the pattern
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_help">
                    --help
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Display help message and exit
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_host">
                    -h name
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Host name of the server in the log file name
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_instance">
                    -i name
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Name of the server instance
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_lock">
                    -l
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Do not subtract lock time from total time
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_reverse">
                    -r
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Reverse the sort order
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_sort">
                    -s value
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                How to sort output
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_top">
                    -t num
                </a>
            </td>
            <td>
                &nbsp;
            </td>
            <td>
                Display only first num queries
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_verbose">
                    --verbose
                </a>
            </td>
            <td>
                <a class="link" href="mysqldumpslow.html#option_mysqldumpslow_verbose">
                    verbose
                </a>
            </td>
            <td>
                Verbose mode
            </td>
        </tr>
    </tbody>
</table>

* --help

	显示帮助信息后退出

* -a

	不把所有的数字简写成 'N'，也不把所有的字符串简写成 'S'

* --debug,-a

	在调试模式下运行

* -g pattern

	只考虑匹配正则的查询(grep-style)

* -h host_name

	日志文件`*-slow.log` 所在的MySQL服务器主机名，可以包含通配符，默认的是\*(匹配所有)

* -i name

	服务器实例的名字(如果使用 [mysql.server][4.3.3]脚本启动)

* -l

	在总时间里不剪掉加锁时间

* -n N

	在名字内部，至少抽出N位

* -r

	反序排列

* -s sort_type

	怎样排序输出，`sort_type` 的值如下：
	
	- t,at:按查询时间或平均查询时间排序
	- l,al:按加锁时间或平均加锁时间
	- r,ar:按记录发送时间或平均发送时间
	- c: 按总量排排序
	
	默认情况下，[mysqldumpslow](#) 按平均查询时间排序（相当于 -s at)

* -t N

	只输出前N个查询

* --verboser,-v

	详情模式，输出更多程序执行的信息

一个例子如下：


```shell
shell> mysqldumpslow

Reading mysql slow query log from /usr/local/mysql/data/mysqld51-apple-slow.log
Count: 1  Time=4.32s (4s)  Lock=0.00s (0s)  Rows=0.0 (0), root[root]@localhost
 insert into t2 select * from t1

Count: 3  Time=2.53s (7s)  Lock=0.00s (0s)  Rows=0.0 (0), root[root]@localhost
 insert into t2 select * from t1 limit N

Count: 3  Time=2.13s (6s)  Lock=0.00s (0s)  Rows=0.0 (0), root[root]@localhost
 insert into t1 select * from t1
```
	



[4.3.3]:./Chapter_3/
[5.2.5]:../Chapter_5/